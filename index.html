<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>LoVasASudar.com ‚Äì Calculadora de castigo cal√≥rico de fiesta</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO b√°sico -->
  <meta name="description" content="LoVasASudar.com: mete lo que vas a comer y beber y descubre cu√°nto ejercicio tendr√≠as que hacer para sudarlo. Ideal para cenas y noches de fiesta con colegas.">
  <meta name="keywords" content="calor√≠as, ejercicio, fiesta, copas, calculadora calor√≠as, quemar calor√≠as, running, gimnasio, dieta, pizza, alcohol">
  <meta name="robots" content="index,follow">
  <link rel="canonical" href="https://lovasasudar.com/">

  <!-- Open Graph / redes -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="LoVasASudar.com ‚Äì Calculadora de castigo cal√≥rico para noches de fiesta">
  <meta property="og:description" content="El juego web que te dice cu√°nto tienes que sudar por tus pizzas, hamburguesas y gin-tonics.">
  <meta property="og:url" content="https://lovasasudar.com/">
  <!-- Cuando tengas una imagen de portada, cambia esta URL -->
  <!-- <meta property="og:image" content="https://lovasasudar.com/imagen-portada.png"> -->

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="LoVasASudar.com ‚Äì Calculadora de castigo cal√≥rico de fiesta">
  <meta name="twitter:description" content="Mete comida y copas y descubre cu√°nto ejercicio tendr√≠as que hacer para sudarlo.">

  <!-- Google Search Console: cuando crees la propiedad, pega aqu√≠ la meta de verificaci√≥n -->
  <!-- <meta name="google-site-verification" content="TU_CODIGO_AQUI"> -->

  <!-- Schema.org b√°sico -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "LoVasASudar.com",
    "url": "https://lovasasudar.com/",
    "description": "Calculadora gamberra de calor√≠as para noches de fiesta: introduces comida y copas y te dice cu√°nto ejercicio necesitar√≠as para compensarlas."
  }
  </script>

  <style>
    :root {
      --primary: #5b7cfa;
      --primary-soft: rgba(91, 124, 250, 0.15);
      --accent: #ff5bcb;
      --accent-soft: rgba(255, 91, 203, 0.15);
      --bg: #050818;
      --bg-alt: #090d23;
      --card-bg: #0c1027;
      --text-main: #f8f9ff;
      --text-soft: #a5add9;
      --danger: #ff7676;
      --border: #252a4a;
      --radius-lg: 18px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at top, rgba(91, 124, 250, 0.25), transparent 55%),
        radial-gradient(circle at 80% 0, rgba(255, 91, 203, 0.18), transparent 50%),
        var(--bg);
      color: var(--text-main);
    }

    .app {
      max-width: 1150px;
      margin: 0 auto;
      padding: 24px 16px 40px;
      position: relative;
    }

    /* Selector idioma */
    .lang-switcher {
      position: absolute;
      top: 16px;
      right: 16px;
      display: flex;
      gap: 6px;
      z-index: 10;
    }

    .lang-btn {
      border-radius: 999px;
      border: 1px solid rgba(159, 168, 255, 0.6);
      background: rgba(9, 13, 35, 0.95);
      color: #f8f9ff;
      font-size: 0.75rem;
      padding: 4px 10px;
      cursor: pointer;
      transition: background 0.15s, box-shadow 0.15s, transform 0.06s;
    }

    .lang-btn.active {
      background: linear-gradient(135deg, #5b7cfa, #ff5bcb);
      box-shadow:
        0 0 12px rgba(91, 124, 250, 0.7),
        0 0 18px rgba(255, 91, 203, 0.7);
      transform: translateY(-1px);
    }

    header {
      text-align: center;
      margin-bottom: 18px;
    }

    h1 {
      margin: 0;
      font-size: 2.1rem;
      font-weight: 900;
      letter-spacing: 0.03em;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(91, 124, 250, 0.9);
    }

    header p {
      margin: 8px auto 0;
      color: var(--text-soft);
      font-size: 0.95rem;
      max-width: 520px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(120deg, rgba(91, 124, 250, 0.25), rgba(255, 91, 203, 0.25));
      color: #ffffff;
      border-radius: 999px;
      padding: 4px 12px;
      font-size: 0.8rem;
      margin-bottom: 10px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 0 12px rgba(91, 124, 250, 0.5);
    }

    .pill span {
      font-size: 1rem;
    }

    .layout {
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .card {
      background: radial-gradient(circle at top left, rgba(91, 124, 250, 0.16), transparent 55%),
                  radial-gradient(circle at bottom right, rgba(255, 91, 203, 0.12), transparent 55%),
                  var(--card-bg);
      border-radius: var(--radius-lg);
      padding: 16px 16px 18px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.75);
      border: 1px solid rgba(159, 168, 255, 0.15);
    }

    .card h2 {
      margin: 0 0 8px;
      font-size: 1.05rem;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #ffffff;
    }

    .card h2 span.emoji {
      font-size: 1.2rem;
    }

    .card small {
      display: block;
      margin-top: 2px;
      color: var(--text-soft);
      font-size: 0.8rem;
    }

    /* FORM EN HORIZONTAL */
    .form-grid {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.4fr);
      gap: 16px;
      align-items: flex-start;
    }

    @media (max-width: 900px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
    }

    .section-card {
      background: rgba(9, 13, 35, 0.92);
      border-radius: 16px;
      padding: 10px 12px 12px;
      border: 1px solid rgba(102, 111, 214, 0.7);
    }

    .section-card.right {
      border-color: rgba(255, 91, 203, 0.7);
    }

    .section-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }

    .section-title small {
      margin-top: 0;
    }

    .section-badge {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.18);
      background: linear-gradient(120deg, rgba(91, 124, 250, 0.3), rgba(255, 91, 203, 0.3));
      color: #fdfdff;
      white-space: nowrap;
    }

    .field {
      margin-bottom: 8px;
    }

    .field label {
      display: block;
      font-size: 0.86rem;
      margin-bottom: 4px;
      color: #dde1ff;
    }

    .field-row {
      display: flex;
      gap: 8px;
    }

    input[type="number"],
    input[type="text"],
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 0.9rem;
      outline: none;
      background: #050819;
      color: var(--text-main);
      transition: border 0.15s, box-shadow 0.15s, background 0.15s;
    }

    input[type="number"]:focus,
    input[type="text"]:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(255, 91, 203, 0.4);
      background: #080d22;
    }

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type="number"] {
      -moz-appearance: textfield;
    }

    .hint {
      font-size: 0.78rem;
      color: var(--text-soft);
      margin-top: 2px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border-radius: 999px;
      padding: 8px 16px;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: transform 0.06s ease, box-shadow 0.1s ease, background 0.15s, filter 0.15s;
      user-select: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #5b7cfa, #ff5bcb);
      color: #fff;
      box-shadow:
        0 0 18px rgba(91, 124, 250, 0.8),
        0 0 28px rgba(255, 91, 203, 0.8);
      width: 100%;
      margin-top: 10px;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      filter: brightness(1.05);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 10px 22px rgba(0, 0, 0, 0.7);
    }

    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 6px;
      margin-bottom: 6px;
      font-size: 0.85rem;
      color: var(--text-soft);
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(91, 124, 250, 0.18);
      border: 1px solid rgba(91, 124, 250, 0.6);
    }

    .toggle-row label {
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      color: #e4e6ff;
    }

    .toggle-row input {
      accent-color: #ff5bcb;
    }

    .toggle-label-strong {
      color: #ffffff;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .toggle-label-strong span {
      font-size: 1.1rem;
    }

    .subcard {
      border-radius: 14px;
      border: 1px solid rgba(255, 91, 203, 0.7);
      padding: 8px 10px;
      background: linear-gradient(135deg, rgba(255, 91, 203, 0.15), rgba(91, 124, 250, 0.15));
      margin-top: 6px;
      margin-bottom: 4px;
      box-shadow: 0 0 18px rgba(255, 91, 203, 0.35);
    }

    .subcard.battle {
      border-color: rgba(91, 124, 250, 0.8);
      background: linear-gradient(135deg, rgba(91, 124, 250, 0.18), rgba(12, 16, 39, 0.95));
      box-shadow: 0 0 18px rgba(91, 124, 250, 0.5);
    }

    .subcard h3 {
      margin: 0 0 4px;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 6px;
      color: #ffffff;
    }

    .subcard h3 span {
      font-size: 1rem;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
      align-items: center;
    }

    .tag-soft {
      font-size: 0.72rem;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(9, 13, 35, 0.9);
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .tag-soft span {
      font-size: 1rem;
    }

    .error {
      margin-top: 6px;
      font-size: 0.8rem;
      color: var(--danger);
    }

    hr.divider {
      border: none;
      border-top: 1px solid rgba(116, 125, 214, 0.4);
      margin: 10px 0;
    }

    /* RESULTADOS */
    .results-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 4px;
    }

    .results-header h2 {
      margin: 0;
      font-size: 1.05rem;
      color: #ffffff;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge-kcal {
      background: rgba(255, 200, 120, 0.16);
      color: #ffd9a0;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.78rem;
      border: 1px solid rgba(255, 200, 120, 0.65);
      white-space: nowrap;
      box-shadow: 0 0 12px rgba(255, 193, 94, 0.7);
    }

    .phrase {
      font-size: 0.9rem;
      color: var(--text-soft);
      margin-bottom: 8px;
      padding-bottom: 6px;
      border-bottom: 1px dashed rgba(159, 168, 255, 0.5);
    }

    .people-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 8px;
    }

    .people-tabs button {
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(116, 125, 214, 0.75);
      background: rgba(9, 13, 35, 0.9);
      cursor: pointer;
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .people-tabs button span.icon {
      font-size: 0.9rem;
    }

    .people-tabs button.active {
      border-color: rgba(255, 91, 203, 0.9);
      background: radial-gradient(circle at top, rgba(255, 91, 203, 0.35), transparent 60%);
      color: #ffffff;
      font-weight: 600;
      box-shadow: 0 0 14px rgba(255, 91, 203, 0.7);
    }

    .table-wrapper {
      max-height: 380px;
      overflow: auto;
      border-radius: 10px;
      border: 1px solid rgba(87, 96, 193, 0.7);
      background: rgba(7, 10, 29, 0.96);
      box-shadow: inset 0 0 18px rgba(0, 0, 0, 0.7);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82rem;
      color: #e4e6ff;
    }

    thead {
      position: sticky;
      top: 0;
      background: linear-gradient(90deg, rgba(91, 124, 250, 0.4), rgba(255, 91, 203, 0.4));
      z-index: 1;
    }

    th, td {
      padding: 6px 8px;
      text-align: left;
      border-bottom: 1px solid rgba(50, 56, 121, 0.9);
    }

    th {
      font-weight: 600;
      font-size: 0.8rem;
    }

    tbody tr:nth-child(even) {
      background: rgba(12, 16, 39, 0.96);
    }

    tbody tr:nth-child(odd) {
      background: rgba(8, 11, 30, 0.96);
    }

    .activity-name {
      font-weight: 500;
      color: #ffffff;
    }

    .activity-soft {
      font-size: 0.78rem;
      color: var(--text-soft);
    }

    .disclaimer {
      margin-top: 10px;
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    .disclaimer strong {
      color: #ffffff;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Selector de idioma -->
    <div class="lang-switcher">
      <button type="button" class="lang-btn active" data-lang="es">ES</button>
      <button type="button" class="lang-btn" data-lang="en">EN</button>
    </div>

    <header>
      <div class="pill">
        <span>üî•</span>
        <span data-i18n="header.pill">LoVasASudar.com ¬∑ Calculadora de castigo cal√≥rico</span>
      </div>
      <h1 data-i18n="header.title">LoVasASudar.com</h1>
      <p data-i18n="header.subtitle">
        Mete lo que vas a comer y beber y descubre cu√°nto ejercicio tendr√≠as que hacer para sudarlo.
        Perfecta para cenas con amigos y noches de copas.
      </p>
    </header>

    <div class="layout">
      <!-- FORMULARIO EN HORIZONTAL -->
      <div class="card">
        <div class="form-grid">
          <!-- PERFIL -->
          <div class="section-card">
            <div class="section-title">
              <div>
                <h2>
                  <span class="emoji">üë§</span>
                  <span data-i18n="profile.title">Tu perfil</span>
                </h2>
                <small data-i18n="profile.subtitle">
                  Pon tus datos b√°sicos para estimar el gasto.
                </small>
              </div>
              <div class="section-badge" data-i18n="profile.badge">
                0% serio, 100% fiesta
              </div>
            </div>

            <div class="field">
              <label for="peso" data-i18n="profile.weightLabel">Peso (kg)</label>
              <input type="number" id="peso" min="30" max="250" placeholder="80">
              <div class="hint" data-i18n="profile.weightHint">
                El c√°lculo se hace por kg de peso (ecuaci√≥n basada en MET).
              </div>
            </div>

            <div class="field">
              <label for="sexo" data-i18n="profile.genderLabel">G√©nero (opcional)</label>
              <select id="sexo">
                <option value=""></option>
                <option value="hombre"></option>
                <option value="mujer"></option>
                <option value="otro"></option>
              </select>
              <div class="hint" data-i18n="profile.genderHint">
                A igualdad de peso, hombres y mujeres suelen quemar algo diferente. Aqu√≠ aplicamos
                un ajuste sencillo (~5%) para reflejarlo de forma aproximada.
              </div>
            </div>

            <div class="toggle-row">
              <span class="toggle-label-strong">
                <span>‚öîÔ∏è</span>
                <span data-i18n="battle.toggleTitle">Batalla de colegas</span>
              </span>
              <label>
                <input type="checkbox" id="toggleBattle">
                <span data-i18n="generic.enable">Activar</span>
              </label>
            </div>

            <div id="battleBlock" class="subcard battle" style="display:none;">
              <h3>
                <span>üë•</span>
                <span data-i18n="battle.title">Batalla de colegas</span>
              </h3>
              <div class="field-row">
                <div class="field">
                  <label data-i18n="battle.name1">Nombre 1</label>
                  <input type="text" id="friend1Name" placeholder="Alex">
                </div>
                <div class="field">
                  <label data-i18n="battle.weight1">Peso 1 (kg)</label>
                  <input type="number" id="friend1Weight" min="30" max="250">
                </div>
              </div>
              <div class="field-row">
                <div class="field">
                  <label data-i18n="battle.name2">Nombre 2</label>
                  <input type="text" id="friend2Name" placeholder="Marta">
                </div>
                <div class="field">
                  <label data-i18n="battle.weight2">Peso 2 (kg)</label>
                  <input type="number" id="friend2Weight" min="30" max="250">
                </div>
              </div>
              <div class="field-row">
                <div class="field">
                  <label data-i18n="battle.name3">Nombre 3</label>
                  <input type="text" id="friend3Name" placeholder="Juan">
                </div>
                <div class="field">
                  <label data-i18n="battle.weight3">Peso 3 (kg)</label>
                  <input type="number" id="friend3Weight" min="30" max="250">
                </div>
              </div>
              <div class="hint" data-i18n="battle.hint">
                Si nadie aqu√≠ tiene peso v√°lido, solo te usamos a ti. Si los rellenas, todos comparten castigo cal√≥rico.
              </div>
            </div>
          </div>

          <!-- COMIDA Y COPAS -->
          <div class="section-card right">
            <div class="section-title">
              <div>
                <h2>
                  <span class="emoji">üçî</span>
                  <span data-i18n="food.title">Lo que vas a tomar</span>
                </h2>
                <small data-i18n="food.subtitle">
                  Elige algo conocido o pon t√∫ las calor√≠as.
                </small>
              </div>
              <div class="section-badge" data-i18n="food.badge">
                Modo noche de fiesta üåô
              </div>
            </div>

            <div class="field">
              <label for="foodSelect" data-i18n="food.labelMain">
                Alimento o bebida (lista ‚Äúde culto‚Äù)
              </label>
              <select id="foodSelect">
                <option value="0" data-label="">‚Äî</option>
                <!-- McDonald's / fast food -->
                <option value="500" data-label="Happy Meal McDonald's">Happy Meal McDonald's (~500 kcal)</option>
                <option value="550" data-label="Big Mac">Big Mac (~550 kcal)</option>
                <option value="510" data-label="Men√∫ mediano McDonald's">Men√∫ mediano McDonald's (~510 kcal)</option>
                <option value="700" data-label="Whopper Burger King">Whopper Burger King (~700 kcal)</option>
                <option value="800" data-label="Men√∫ Whopper mediano">Men√∫ Whopper mediano (~800 kcal)</option>
                <option value="480" data-label="McPollo">McPollo (~480 kcal)</option>
                <option value="250" data-label="6 Nuggets McDonald's">6 Nuggets McDonald's (~250 kcal)</option>
                <option value="340" data-label="Patatas fritas medianas McDonald's">Patatas medianas McDonald's (~340 kcal)</option>
                <option value="420" data-label="Patatas gajo Burger King">Patatas gajo Burger King (~420 kcal)</option>

                <!-- Pizza / italiano (1/8 pizza mediana) -->
                <option value="450" data-label="Porci√≥n pizza queso (1/8 mediana)">Porci√≥n pizza queso (1/8 pizza mediana ~450 kcal)</option>
                <option value="500" data-label="Porci√≥n pizza pepperoni (1/8 mediana)">Porci√≥n pizza pepperoni (1/8 pizza mediana ~500 kcal)</option>
                <option value="3600" data-label="Pizza familiar queso entera">Pizza familiar queso entera (~3600 kcal aprox.)</option>
                <option value="4000" data-label="Pizza familiar pepperoni entera">Pizza familiar pepperoni entera (~4000 kcal aprox.)</option>
                <option value="600" data-label="Lasa√±a bolo√±esa">Lasa√±a bolo√±esa (~600 kcal)</option>
                <option value="700" data-label="Raci√≥n pasta carbonara">Raci√≥n pasta carbonara (~700 kcal)</option>

                <!-- Tapas / comida espa√±ola -->
                <option value="250" data-label="Pincho de tortilla">Pincho de tortilla (~250 kcal)</option>
                <option value="500" data-label="Raci√≥n patatas bravas">Raci√≥n patatas bravas (~500 kcal)</option>
                <option value="350" data-label="3 croquetas de jam√≥n">3 croquetas de jam√≥n (~350 kcal)</option>
                <option value="450" data-label="Bocadillo de jam√≥n serrano">Bocadillo de jam√≥n serrano (~450 kcal)</option>
                <option value="550" data-label="Bocadillo de calamares">Bocadillo de calamares (~550 kcal)</option>

                <!-- Dulces / boller√≠a -->
                <option value="280" data-label="Donut cl√°sico">Donut cl√°sico (~280 kcal)</option>
                <option value="220" data-label="Croissant de mantequilla">Croissant de mantequilla (~220 kcal)</option>
                <option value="400" data-label="Palmera de chocolate">Palmera de chocolate (~400 kcal)</option>
                <option value="450" data-label="Brownie de chocolate">Brownie de chocolate (~450 kcal)</option>
                <option value="450" data-label="Muffin de chocolate">Muffin de chocolate (~450 kcal)</option>
                <option value="550" data-label="Tarta de queso porci√≥n">Tarta de queso porci√≥n (~550 kcal)</option>
                <option value="500" data-label="Tarta de chocolate porci√≥n">Tarta de chocolate porci√≥n (~500 kcal)</option>

                <!-- Snacks / chocolatinas -->
                <option value="150" data-label="Barrita chocolate tipo KitKat">Barrita chocolate tipo KitKat (~150 kcal)</option>
                <option value="240" data-label="Barrita Snickers">Barrita Snickers (~240 kcal)</option>
                <option value="250" data-label="Bolsa patatas fritas peque√±a">Patatas fritas bolsa peque√±a (~250 kcal)</option>
                <option value="500" data-label="Bolsa patatas fritas grande">Patatas fritas bolsa grande (~500 kcal)</option>
                <option value="200" data-label="Kinder Bueno (2 barritas)">Kinder Bueno (2 barritas) (~200 kcal)</option>
                <option value="200" data-label="Helado de palo cremoso">Helado de palo cremoso (~200 kcal)</option>
                <option value="280" data-label="Helado tipo Magnum">Helado tipo Magnum (~280 kcal)</option>

                <!-- Bebidas y cocktails -->
                <option value="150" data-label="Cerveza 330 ml">Cerveza 330 ml (~150 kcal)</option>
                <option value="210" data-label="Gin-tonic est√°ndar">Gin-tonic est√°ndar (~210 kcal)</option>
                <option value="200" data-label="Ron-cola">Ron-cola (~200 kcal)</option>
                <option value="240" data-label="Mojito">Mojito (~240 kcal)</option>
                <option value="230" data-label="Sex on the Beach">Sex on the Beach (~230 kcal)</option>
                <option value="250" data-label="Caipiri√±a">Caipiri√±a (~250 kcal)</option>
                <option value="300" data-label="Pi√±a colada">Pi√±a colada (~300 kcal)</option>
                <option value="200" data-label="Whisky-cola">Whisky-cola (~200 kcal)</option>
                <option value="200" data-label="Aperol Spritz">Aperol Spritz (~200 kcal)</option>
                <option value="65" data-label="Chupito tequila">Chupito de tequila (~65 kcal)</option>
                <option value="90" data-label="Copa de vino tinto">Copa de vino tinto (~90 kcal)</option>
                <option value="110" data-label="Copa de vino blanco">Copa de vino blanco (~110 kcal)</option>
                <option value="120" data-label="Refresco azucarado 330 ml">Refresco azucarado 330 ml (~120 kcal)</option>
                <option value="100" data-label="Verm√∫">Verm√∫ (~100 kcal)</option>
                <option value="180" data-label="Cerveza artesana 330 ml">Cerveza artesana 330 ml (~180 kcal)</option>

                <!-- Otros -->
                <option value="650" data-label="Hamburguesa casera completa">Hamburguesa casera completa (~650 kcal)</option>
                <option value="350" data-label="Raci√≥n de sushi (8 piezas)">Raci√≥n de sushi (8 piezas) (~350 kcal)</option>
                <option value="300" data-label="Ensalada C√©sar completa">Ensalada C√©sar completa (~300 kcal)</option>

                <!-- Sin selecci√≥n -->
                <option value="custom" data-label="Personalizado">Otro / none</option>
              </select>
            </div>

            <div class="field-row">
              <div class="field">
                <label for="unidades" data-i18n="food.unitsLabel">N.¬∫ de unidades</label>
                <input type="number" id="unidades" min="1" value="1">
                <div class="hint" data-i18n="food.unitsHint">
                  Ej: 3 cervezas ‚Üí pon 3 unidades.
                </div>
              </div>
              <div class="field">
                <label for="customKcal" data-i18n="food.extraLabel">Calor√≠as extra</label>
                <input type="number" id="customKcal" min="1" placeholder="750">
                <div class="hint" data-i18n="food.extraHint">
                  Se suman a lo anterior (comida + copas).
                </div>
              </div>
            </div>

            <hr class="divider">

            <!-- TOGGLE MODO NOCHE DE COPAS -->
            <div class="toggle-row">
              <span class="toggle-label-strong">
                <span>üçπ</span>
                <span data-i18n="drinks.toggleTitle">Modo noche de copas</span>
              </span>
              <label>
                <input type="checkbox" id="toggleDrinks">
                <span data-i18n="generic.enable">Activar</span>
              </label>
            </div>

            <!-- MODO NOCHE DE COPAS (colapsable) -->
            <div id="drinksBlock" class="subcard" style="display:none;">
              <h3>
                <span>üåô</span>
                <span data-i18n="drinks.title">Noche de copas</span>
              </h3>
              <div class="field-row">
                <div class="field">
                  <label for="drinkSelect" data-i18n="drinks.drinkLabel">Bebida</label>
                  <select id="drinkSelect">
                    <option value="">‚Äî</option>
                    <option value="150">Cerveza 330 ml (~150 kcal)</option>
                    <option value="180">Cerveza artesana 330 ml (~180 kcal)</option>
                    <option value="210">Gin-tonic (~210 kcal)</option>
                    <option value="200">Ron-cola (~200 kcal)</option>
                    <option value="240">Mojito (~240 kcal)</option>
                    <option value="230">Sex on the Beach (~230 kcal)</option>
                    <option value="250">Caipiri√±a (~250 kcal)</option>
                    <option value="300">Pi√±a colada (~300 kcal)</option>
                    <option value="200">Whisky-cola (~200 kcal)</option>
                    <option value="200">Aperol Spritz (~200 kcal)</option>
                    <option value="65">Chupito tequila (~65 kcal)</option>
                    <option value="90">Copa vino tinto (~90 kcal)</option>
                    <option value="110">Copa vino blanco (~110 kcal)</option>
                    <option value="100">Verm√∫ (~100 kcal)</option>
                  </select>
                </div>
                <div class="field">
                  <label for="numCopas" data-i18n="drinks.numLabel">N.¬∫ de copas</label>
                  <input type="number" id="numCopas" min="1" value="3">
                </div>
              </div>
              <div class="chips">
                <span class="tag-soft" data-i18n="drinks.chipText">
                  Estas calor√≠as se suman al resto.
                </span>
              </div>
              <div class="hint" data-i18n="drinks.hint">
                Perfecto para ver cu√°nto ‚Äúvale‚Äù tu noche de copas adem√°s de la cena.
              </div>
            </div>
          </div>
        </div>

        <button class="btn btn-primary" id="btnCalcular">
          <span data-i18n="btn.calculate">Calcular ejercicio necesario</span>
          <span>üí™</span>
        </button>
        <div id="errorBox" class="error" style="display:none;"></div>
      </div>

      <!-- RESULTADOS DEBAJO -->
      <div class="card">
        <div class="results-header">
          <h2>
            <span class="emoji">üìä</span>
            <span data-i18n="results.title">Resultados del castigo cal√≥rico</span>
          </h2>
          <div id="kcalBadge" class="badge-kcal" style="display:none;"></div>
        </div>
        <div id="phraseBox" class="phrase"></div>

        <div id="peopleTabs" class="people-tabs" style="display:none;"></div>

        <div class="table-wrapper" id="tableWrapper" style="display:none;">
          <table>
            <thead>
              <tr>
                <th data-i18n="table.activity">Actividad</th>
                <th data-i18n="table.time">Tiempo aprox.</th>
                <th data-i18n="table.distance">Distancia aprox.</th>
              </tr>
            </thead>
            <tbody id="resultsBody">
              <!-- Filas din√°micas -->
            </tbody>
          </table>
        </div>

        <div id="disclaimer" class="disclaimer"></div>
      </div>
    </div>
  </div>

  <script>
    // --- Idioma actual ---
    let currentLang = 'es';

    const I18N = {
      es: {
        'doc.title': 'LoVasASudar.com ‚Äì Calculadora de castigo cal√≥rico de fiesta',
        'header.pill': 'LoVasASudar.com ¬∑ Calculadora de castigo cal√≥rico',
        'header.title': 'LoVasASudar.com',
        'header.subtitle':
          'Mete lo que vas a comer y beber y descubre cu√°nto ejercicio tendr√≠as que hacer para sudarlo. Perfecta para cenas con amigos y noches de copas.',

        'profile.title': 'Tu perfil',
        'profile.subtitle': 'Pon tus datos b√°sicos para estimar el gasto.',
        'profile.badge': '0% serio, 100% fiesta',
        'profile.weightLabel': 'Peso (kg)',
        'profile.weightHint': 'El c√°lculo se hace por kg de peso (ecuaci√≥n basada en MET).',
        'profile.genderLabel': 'G√©nero (opcional)',
        'profile.genderHint':
          'A igualdad de peso, hombres y mujeres suelen quemar algo diferente. Aqu√≠ aplicamos un ajuste sencillo (~5%) para reflejarlo de forma aproximada.',

        'battle.toggleTitle': 'Batalla de colegas',
        'battle.title': 'Batalla de colegas',
        'battle.name1': 'Nombre 1',
        'battle.weight1': 'Peso 1 (kg)',
        'battle.name2': 'Nombre 2',
        'battle.weight2': 'Peso 2 (kg)',
        'battle.name3': 'Nombre 3',
        'battle.weight3': 'Peso 3 (kg)',
        'battle.hint':
          'Si nadie aqu√≠ tiene peso v√°lido, solo te usamos a ti. Si los rellenas, todos comparten castigo cal√≥rico.',

        'food.title': 'Lo que vas a tomar',
        'food.subtitle': 'Elige algo conocido o pon t√∫ las calor√≠as.',
        'food.badge': 'Modo noche de fiesta üåô',
        'food.labelMain': 'Alimento o bebida (lista ‚Äúde culto‚Äù)',
        'food.unitsLabel': 'N.¬∫ de unidades',
        'food.unitsHint': 'Ej: 3 cervezas ‚Üí pon 3 unidades.',
        'food.extraLabel': 'Calor√≠as extra',
        'food.extraHint': 'Se suman a lo anterior (comida + copas).',

        'drinks.toggleTitle': 'Modo noche de copas',
        'drinks.title': 'Noche de copas',
        'drinks.drinkLabel': 'Bebida',
        'drinks.numLabel': 'N.¬∫ de copas',
        'drinks.chipText': 'Estas calor√≠as se suman al resto.',
        'drinks.hint': 'Perfecto para ver cu√°nto ‚Äúvale‚Äù tu noche de copas adem√°s de la cena.',

        'btn.calculate': 'Calcular ejercicio necesario',

        'results.title': 'Resultados del castigo cal√≥rico',
        'table.activity': 'Actividad',
        'table.time': 'Tiempo aprox.',
        'table.distance': 'Distancia aprox.',

        'phrase.initial':
          'Introduce tu peso, elige comida o bebida, y pulsa en <strong>‚ÄúCalcular ejercicio necesario‚Äù</strong>. Luego decide si prefieres correr, bailar, jugar al p√°del‚Ä¶ o abrazar la petanca.',

        'disclaimer':
          '<strong>Nota seria dentro de la broma:</strong> los c√°lculos usan la f√≥rmula est√°ndar basada en MET (equivalentes metab√≥licos) multiplicados por tu peso y un peque√±o ajuste por g√©nero cuando se indica. Son aproximaciones pensadas para concienciar y divertir, no para prescripci√≥n m√©dica ni deportiva profesional.',

        'generic.enable': 'Activar',

        // Select g√©nero
        'gender.opt0': 'Prefiero no decirlo',
        'gender.optMale': 'Hombre',
        'gender.optFemale': 'Mujer',
        'gender.optOther': 'Otro'
      },
      en: {
        'doc.title': 'LoVasASudar.com ‚Äì Party calorie punishment calculator',
        'header.pill': 'LoVasASudar.com ¬∑ Calorie punishment calculator',
        'header.title': 'LoVasASudar.com',
        'header.subtitle':
          'Enter what you are going to eat and drink and see how much exercise you would need to sweat it out. Perfect for dinners with friends and party nights.',

        'profile.title': 'Your profile',
        'profile.subtitle': 'Fill your basic data to estimate energy cost.',
        'profile.badge': '0% serious, 100% party',
        'profile.weightLabel': 'Weight (kg)',
        'profile.weightHint': 'The calculation uses your weight in kg (MET-based equation).',
        'profile.genderLabel': 'Gender (optional)',
        'profile.genderHint':
          'For the same weight, men and women often burn slightly different amounts. We apply a simple (~5%) adjustment to reflect that roughly.',

        'battle.toggleTitle': 'Friends battle',
        'battle.title': 'Friends battle',
        'battle.name1': 'Name 1',
        'battle.weight1': 'Weight 1 (kg)',
        'battle.name2': 'Name 2',
        'battle.weight2': 'Weight 2 (kg)',
        'battle.name3': 'Name 3',
        'battle.weight3': 'Weight 3 (kg)',
        'battle.hint':
          'If no valid weight is set here, only you are used. If you fill them, everyone shares the calorie punishment.',

        'food.title': 'What you‚Äôre having',
        'food.subtitle': 'Pick something from the list or enter calories yourself.',
        'food.badge': 'Party night mode üåô',
        'food.labelMain': 'Food or drink (cult list)',
        'food.unitsLabel': 'Number of units',
        'food.unitsHint': 'Example: 3 beers ‚Üí enter 3 units.',
        'food.extraLabel': 'Extra calories',
        'food.extraHint': 'These are added on top (food + drinks).',

        'drinks.toggleTitle': 'Night drinks mode',
        'drinks.title': 'Night of drinks',
        'drinks.drinkLabel': 'Drink',
        'drinks.numLabel': 'Number of drinks',
        'drinks.chipText': 'These calories are added to the total.',
        'drinks.hint': 'Perfect to see how much your drinks ‚Äúcost‚Äù on top of dinner.',

        'btn.calculate': 'Calculate required exercise',

        'results.title': 'Calorie punishment results',
        'table.activity': 'Activity',
        'table.time': 'Approx. time',
        'table.distance': 'Approx. distance',

        'phrase.initial':
          'Enter your weight, choose food or drinks and click <strong>‚ÄúCalculate required exercise‚Äù</strong>. Then decide if you want to run, dance, play padel‚Ä¶ or fully embrace p√©tanque.',

        'disclaimer':
          '<strong>Serious note behind the joke:</strong> calculations use the standard MET-based formula (metabolic equivalents) multiplied by your weight, plus a small gender adjustment when given. These are rough estimates for awareness and fun, not medical or professional training advice.',

        'generic.enable': 'Enable',

        'gender.opt0': 'Prefer not to say',
        'gender.optMale': 'Male',
        'gender.optFemale': 'Female',
        'gender.optOther': 'Other'
      }
    };

    const MESSAGES = {
      es: {
        errorUnits: 'Introduce un n√∫mero de unidades v√°lido (m√≠nimo 1).',
        errorWeight: 'Introduce tu peso en kg (entre 30 y 250 kg).',
        errorNoKcal: 'Necesitamos al menos alguna calor√≠a (comida, copas o extra) para calcular.',
        errorDrinksInvalid: 'Para el modo copas, elige una bebida y un n√∫mero de copas v√°lidos.'
      },
      en: {
        errorUnits: 'Enter a valid number of units (minimum 1).',
        errorWeight: 'Enter your weight in kg (between 30 and 250 kg).',
        errorNoKcal: 'We need at least some calories (food, drinks or extra) to calculate.',
        errorDrinksInvalid: 'For drinks mode, choose a drink and a valid number of drinks.'
      }
    };

    const PHRASES = {
      es: [
        (k, l) => `Tu elecci√≥n (${l}) son aproximadamente ${k} kcal. No es pecado, pero el cuerpo te lo va a cobrar en sudor.`,
        (k, l) => `Eso que vas a tomar (${l}) equivale a una peque√±a negociaci√≥n con tu sistema cardiovascular: ${k} kcal en la mesa, a cambio de deporte despu√©s.`,
        (k, l) => `Si las calor√≠as fuesen una moneda, ${l} te est√° saliendo caro: ${k} monedas de sudor.`,
        (k, l) => `Buenas noticias: ${l} no es eterno. Malas noticias: las ${k} kcal tampoco desaparecen solas.`,
        (k, l) => `Tu ${l} es b√°sicamente un ‚Äúpr√©stamo‚Äù de ${k} kcal. Este simulador te ense√±a el plan de devoluci√≥n.`,
        (k, l) => `Esto (${l}) son ${k} kcal. No hace falta sentirse culpable, pero s√≠ responsable‚Ä¶ o al menos re√≠rse un rato calculando el castigo.`
      ],
      en: [
        (k, l) => `Your choice (${l}) is roughly ${k} kcal. Not a crime, but your body will charge interest in sweat.`,
        (k, l) => `What you're having (${l}) is a small negotiation with your cardiovascular system: ${k} kcal on the table, exercise as repayment.`,
        (k, l) => `If calories were a currency, ${l} is quite pricey: ${k} sweat coins.`,
        (k, l) => `Good news: ${l} won‚Äôt last forever. Bad news: those ${k} kcal won‚Äôt vanish by themselves.`,
        (k, l) => `Your ${l} is basically a ‚Äúloan‚Äù of ${k} kcal. This simulator shows your repayment plan.`,
        (k, l) => `This (${l}) is ${k} kcal. No need for guilt, just a bit of responsibility‚Ä¶ and maybe a laugh while you check the punishment.`
      ]
    };

    const ACTIVITIES = [
      {
        id: 'correr',
        name: { es: 'Correr', en: 'Running' },
        met: 8.5, hasDistance: true, speed: 8,
        note: { es: 'trote alegre ~8 km/h', en: 'easy run ~8 km/h' }
      },
      {
        id: 'andar',
        name: { es: 'Andar r√°pido', en: 'Brisk walking' },
        met: 3.8, hasDistance: true, speed: 5.5,
        note: { es: 'paseo ligero ~5,5 km/h', en: 'light walk ~5.5 km/h' }
      },
      {
        id: 'bailar',
        name: { es: 'Bailar', en: 'Dancing' },
        met: 6, hasDistance: false,
        note: { es: 'discoteca / ‚ÄúManiac‚Äù vibes', en: 'club dancing / ‚ÄúManiac‚Äù vibes' }
      },
      {
        id: 'futbol',
        name: { es: 'F√∫tbol', en: 'Football / Soccer' },
        met: 7, hasDistance: false,
        note: { es: 'partido informal con colegas', en: 'casual match with friends' }
      },
      {
        id: 'artes_marciales',
        name: { es: 'Artes marciales', en: 'Martial arts' },
        met: 10, hasDistance: false,
        note: { es: 'sparring / combate', en: 'sparring / fighting' }
      },
      {
        id: 'musculacion',
        name: { es: 'Musculaci√≥n (gym)', en: 'Weight training (gym)' },
        met: 6, hasDistance: false,
        note: { es: 'entreno serio, no selfies', en: 'serious workout, not selfies' }
      },
      {
        id: 'body_combat',
        name: { es: 'Body combat', en: 'Body combat' },
        met: 8, hasDistance: false,
        note: { es: 'clase dirigida alta intensidad', en: 'high-intensity class' }
      },
      {
        id: 'spinning',
        name: { es: 'Spinning', en: 'Spinning' },
        met: 9, hasDistance: false,
        note: { es: 'clase de bici indoor a tope', en: 'intense indoor cycling class' }
      },
      {
        id: 'bici_exterior',
        name: { es: 'Bicicleta exterior', en: 'Outdoor cycling' },
        met: 7, hasDistance: true, speed: 18,
        note: { es: 'bici urbana / paseo r√°pido', en: 'urban / fast leisure cycling' }
      },
      {
        id: 'nadar',
        name: { es: 'Nadar', en: 'Swimming' },
        met: 6.5, hasDistance: false,
        note: { es: 'crol moderado', en: 'moderate freestyle' }
      },
      {
        id: 'alpinismo',
        name: { es: 'Alpinismo / senderismo', en: 'Hiking / mountaineering' },
        met: 7, hasDistance: true, speed: 4,
        note: { es: 'subida con desnivel', en: 'uphill hiking' }
      },
      {
        id: 'padel',
        name: { es: 'P√°del', en: 'Padel' },
        met: 7, hasDistance: false,
        note: { es: 'partido dobles', en: 'doubles match' }
      },
      {
        id: 'tenis',
        name: { es: 'Tenis', en: 'Tennis' },
        met: 7.3, hasDistance: false,
        note: { es: 'partido recreativo', en: 'recreational match' }
      },
      {
        id: 'atletismo',
        name: { es: 'Atletismo (series)', en: 'Track intervals' },
        met: 10, hasDistance: true, speed: 10,
        note: { es: 'carreras m√°s intensas', en: 'more intense running intervals' }
      },
      {
        id: 'escalada',
        name: { es: 'Escalada', en: 'Climbing' },
        met: 9, hasDistance: false,
        note: { es: 'roc√≥dromo o roca', en: 'indoor or outdoor climbing' }
      },
      {
        id: 'petanca',
        name: { es: 'Petanca', en: 'P√©tanque / boules' },
        met: 2.5, hasDistance: false,
        note: { es: 's√≠, tambi√©n cuenta üòÑ', en: 'yes, this counts too üòÑ' }
      },
      {
        id: 'dardos',
        name: { es: 'Dardos', en: 'Darts' },
        met: 2, hasDistance: false,
        note: { es: 'ideal para la noche de copas', en: 'perfect during a night out' }
      }
    ];

    let currentResults = { people: [], kcal: 0, label: '' };
    let activePersonIndex = 0;

    function tMsg(code) {
      return (MESSAGES[currentLang] && MESSAGES[currentLang][code]) || code;
    }

    function randomPhrase(kcal, label) {
      const arr = PHRASES[currentLang] || PHRASES.es;
      const idx = Math.floor(Math.random() * arr.length);
      return arr[idx](kcal, label || (currentLang === 'en' ? 'your choice' : 'tu elecci√≥n'));
    }

    function formatMinutes(mins) {
      if (mins < 1) {
        return currentLang === 'en' ? 'less than 1 min' : 'menos de 1 min';
      }
      const h = Math.floor(mins / 60);
      const m = Math.round(mins % 60);
      if (h === 0) return `${m} min`;
      if (m === 0) return `${h} h`;
      return `${h} h ${m} min`;
    }

    function formatDistance(km) {
      if (!km || km <= 0.05) return '‚Äî';
      if (km < 1) return `${(km * 1000).toFixed(0)} m`;
      if (km < 10) return `${km.toFixed(1)} km`;
      return `${km.toFixed(1)} km`;
    }

    // DOM
    const langButtons = document.querySelectorAll('.lang-btn');
    const pesoInput = document.getElementById('peso');
    const sexoSelect = document.getElementById('sexo');
    const toggleBattle = document.getElementById('toggleBattle');
    const battleBlock = document.getElementById('battleBlock');
    const toggleDrinks = document.getElementById('toggleDrinks');
    const drinksBlock = document.getElementById('drinksBlock');

    const friendInputs = [
      { name: document.getElementById('friend1Name'), weight: document.getElementById('friend1Weight') },
      { name: document.getElementById('friend2Name'), weight: document.getElementById('friend2Weight') },
      { name: document.getElementById('friend3Name'), weight: document.getElementById('friend3Weight') }
    ];

    const foodSelect = document.getElementById('foodSelect');
    const unidadesInput = document.getElementById('unidades');
    const customKcalInput = document.getElementById('customKcal');

    const drinkSelect = document.getElementById('drinkSelect');
    const numCopasInput = document.getElementById('numCopas');

    const btnCalcular = document.getElementById('btnCalcular');
    const errorBox = document.getElementById('errorBox');

    const phraseBox = document.getElementById('phraseBox');
    const kcalBadge = document.getElementById('kcalBadge');
    const peopleTabs = document.getElementById('peopleTabs');
    const tableWrapper = document.getElementById('tableWrapper');
    const resultsBody = document.getElementById('resultsBody');
    const disclaimerBox = document.getElementById('disclaimer');

    function applyLanguage(lang) {
      currentLang = lang;
      const dict = I18N[lang] || I18N.es;

      document.title = dict['doc.title'] || document.title;

      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key] !== undefined) {
          el.textContent = dict[key];
        }
      });

      // G√©nero select
      const opts = sexoSelect.options;
      if (opts[0]) opts[0].textContent = dict['gender.opt0'];
      if (opts[1]) opts[1].textContent = dict['gender.optMale'];
      if (opts[2]) opts[2].textContent = dict['gender.optFemale'];
      if (opts[3]) opts[3].textContent = dict['gender.optOther'];

      // Frase inicial si no hay resultados todav√≠a
      if (!currentResults.kcal || currentResults.kcal <= 0) {
        phraseBox.innerHTML = dict['phrase.initial'];
      }

      // Disclaimer
      disclaimerBox.innerHTML = dict['disclaimer'];

      // Actualizar resultados si ya existen
      if (currentResults.kcal > 0) {
        renderResults(currentResults.label);
      }

      // Botones idioma
      langButtons.forEach(btn => {
        btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
      });
    }

    langButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const lang = btn.getAttribute('data-lang');
        applyLanguage(lang);
      });
    });

    toggleBattle.addEventListener('change', () => {
      battleBlock.style.display = toggleBattle.checked ? 'block' : 'none';
    });

    toggleDrinks.addEventListener('change', () => {
      drinksBlock.style.display = toggleDrinks.checked ? 'block' : 'none';
    });

    btnCalcular.addEventListener('click', calcular);

    [pesoInput, customKcalInput, unidadesInput].forEach(el => {
      el.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          e.preventDefault();
          calcular();
        }
      });
    });

    function showError(msg) {
      errorBox.textContent = msg;
      errorBox.style.display = 'block';
    }

    function clearError() {
      errorBox.textContent = '';
      errorBox.style.display = 'none';
    }

    function calcular() {
      clearError();

      let foodKcal = 0;
      let manualKcal = 0;
      let drinksKcal = 0;
      const labelParts = [];

      const unidades = parseInt(unidadesInput.value || '1', 10);
      const customKcal = parseFloat(customKcalInput.value);

      const selectedOption = foodSelect.options[foodSelect.selectedIndex];
      const foodValRaw = foodSelect.value;

      if (foodValRaw !== '0' && foodValRaw !== 'custom') {
        const base = parseFloat(foodValRaw || '0');
        if (base > 0) {
          if (!unidades || unidades <= 0) {
            showError(tMsg('errorUnits'));
            return;
          }
          foodKcal = base * unidades;
          const labelFood = selectedOption.dataset.label || selectedOption.textContent;
          if (labelFood) labelParts.push(labelFood + (unidades > 1 ? ` x${unidades}` : ''));
        }
      }

      if (!isNaN(customKcal) && customKcal > 0) {
        manualKcal = customKcal;
        labelParts.push(currentLang === 'en' ? 'Extra calories' : 'Calor√≠as extra');
      }

      if (toggleDrinks.checked) {
        const kcalDrink = parseFloat(drinkSelect.value || '0');
        const n = parseInt(numCopasInput.value || '0', 10);
        if (kcalDrink > 0 && n > 0) {
          drinksKcal = kcalDrink * n;
          const drinkLabel = drinkSelect.options[drinkSelect.selectedIndex].textContent || (currentLang === 'en' ? 'Drinks' : 'Copas');
          labelParts.push(`${drinkLabel} x${n}`);
        } else if (kcalDrink > 0 || n > 0) {
          showError(tMsg('errorDrinksInvalid'));
          return;
        }
      }

      const totalKcal = foodKcal + manualKcal + drinksKcal;

      if (totalKcal <= 0) {
        showError(tMsg('errorNoKcal'));
        return;
      }

      let label = labelParts.join(' + ');
      if (!label) {
        label = currentLang === 'en' ? 'Your choice' : 'Tu elecci√≥n';
      }

      const mainPeso = parseFloat(pesoInput.value);
      if (isNaN(mainPeso) || mainPeso < 30 || mainPeso > 250) {
        showError(tMsg('errorWeight'));
        return;
      }

      const sexo = sexoSelect.value;
      let sexFactor = 1;
      let sexLabel = '';
      if (sexo === 'hombre') {
        sexFactor = 1.0;
        sexLabel = currentLang === 'en' ? 'Male' : 'Hombre';
      } else if (sexo === 'mujer') {
        sexFactor = 0.95;
        sexLabel = currentLang === 'en' ? 'Female' : 'Mujer';
      } else if (sexo === 'otro') {
        sexFactor = 1.0;
        sexLabel = currentLang === 'en' ? 'Other' : 'Otro';
      }

      let people = [];

      if (toggleBattle.checked) {
        friendInputs.forEach((f, idx) => {
          const w = parseFloat(f.weight.value);
          if (!isNaN(w) && w >= 30 && w <= 250) {
            const defaultName = (currentLang === 'en' ? 'Friend ' : 'Amigo ') + (idx + 1);
            const name = (f.name.value || defaultName).trim();
            people.push({ name, weight: w, sexFactor: 1, sexLabel: '' });
          }
        });

        if (people.length === 0) {
          people.push({ name: currentLang === 'en' ? 'You' : 'T√∫', weight: mainPeso, sexFactor, sexLabel });
        } else {
          people.unshift({ name: currentLang === 'en' ? 'You' : 'T√∫', weight: mainPeso, sexFactor, sexLabel });
        }
      } else {
        people.push({ name: currentLang === 'en' ? 'You' : 'T√∫', weight: mainPeso, sexFactor, sexLabel });
      }

      const peopleResults = people.map(person => {
        const rows = ACTIVITIES.map(act => {
          const factor = person.sexFactor || 1;
          const timeHours = totalKcal / (act.met * person.weight * factor);
          const timeMinutes = timeHours * 60;
          const distance = act.hasDistance ? act.speed * timeHours : null;
          return { activity: act, minutes: timeMinutes, distanceKm: distance };
        });
        return { person, rows };
      });

      currentResults.people = peopleResults;
      currentResults.kcal = totalKcal;
      currentResults.label = label;
      activePersonIndex = 0;

      renderResults(label);
    }

    function renderResults(label) {
      const { people, kcal } = currentResults;

      if (!people || people.length === 0) {
        tableWrapper.style.display = 'none';
        peopleTabs.style.display = 'none';
        kcalBadge.style.display = 'none';
        return;
      }

      phraseBox.innerHTML = randomPhrase(Math.round(kcal), label);
      kcalBadge.textContent = `${Math.round(kcal)} kcal`;
      kcalBadge.style.display = 'inline-block';

      if (people.length > 1) {
        renderPeopleTabs();
        peopleTabs.style.display = 'flex';
      } else {
        peopleTabs.style.display = 'none';
      }

      tableWrapper.style.display = 'block';
      renderPersonTable();
    }

    function renderPeopleTabs() {
      const { people } = currentResults;
      peopleTabs.innerHTML = '';
      people.forEach((entry, idx) => {
        const btn = document.createElement('button');
        const labelParts = [`${entry.person.name}`, `${entry.person.weight} kg`];
        if (entry.person.sexLabel) labelParts.push(entry.person.sexLabel);
        btn.innerHTML = `<span class="icon">üéØ</span>${labelParts.join(' ¬∑ ')}`;
        if (idx === activePersonIndex) btn.classList.add('active');
        btn.addEventListener('click', () => {
          activePersonIndex = idx;
          renderPersonTable();
          renderPeopleTabs();
        });
        peopleTabs.appendChild(btn);
      });
    }

    function renderPersonTable() {
      const { people } = currentResults;
      if (!people || people.length === 0) return;

      const entry = people[activePersonIndex];
      resultsBody.innerHTML = '';

      entry.rows.forEach(row => {
        const tr = document.createElement('tr');

        const tdAct = document.createElement('td');
        const nameDiv = document.createElement('div');
        nameDiv.className = 'activity-name';
        nameDiv.textContent = row.activity.name[currentLang] || row.activity.name.es;

        const softDiv = document.createElement('div');
        softDiv.className = 'activity-soft';
        softDiv.textContent = row.activity.note[currentLang] || row.activity.note.es || '';

        tdAct.appendChild(nameDiv);
        tdAct.appendChild(softDiv);

        const tdTime = document.createElement('td');
        tdTime.textContent = formatMinutes(row.minutes);

        const tdDist = document.createElement('td');
        tdDist.textContent = row.activity.hasDistance ? formatDistance(row.distanceKm) : '‚Äî';

        tr.appendChild(tdAct);
        tr.appendChild(tdTime);
        tr.appendChild(tdDist);

        resultsBody.appendChild(tr);
      });
    }

    // Inicializar en espa√±ol
    document.addEventListener('DOMContentLoaded', () => {
      applyLanguage('es');
    });
  </script>
</body>
</html>
